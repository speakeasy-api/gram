// Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.

package components

import (
	"encoding/json"
	"errors"
	"fmt"
	"github.com/speakeasy-api/gram/responses/internal/utils"
	"github.com/speakeasy-api/gram/responses/optionalnullable"
)

// SystemMessageItemParamType - The item type. Always `message`.
type SystemMessageItemParamType string

const (
	SystemMessageItemParamTypeMessage SystemMessageItemParamType = "message"
)

func (e SystemMessageItemParamType) ToPointer() *SystemMessageItemParamType {
	return &e
}
func (e *SystemMessageItemParamType) UnmarshalJSON(data []byte) error {
	var v string
	if err := json.Unmarshal(data, &v); err != nil {
		return err
	}
	switch v {
	case "message":
		*e = SystemMessageItemParamType(v)
		return nil
	default:
		return fmt.Errorf("invalid value for SystemMessageItemParamType: %v", v)
	}
}

// SystemMessageItemParamRole - The message role. Always `system`.
type SystemMessageItemParamRole string

const (
	SystemMessageItemParamRoleSystem SystemMessageItemParamRole = "system"
)

func (e SystemMessageItemParamRole) ToPointer() *SystemMessageItemParamRole {
	return &e
}
func (e *SystemMessageItemParamRole) UnmarshalJSON(data []byte) error {
	var v string
	if err := json.Unmarshal(data, &v); err != nil {
		return err
	}
	switch v {
	case "system":
		*e = SystemMessageItemParamRole(v)
		return nil
	default:
		return fmt.Errorf("invalid value for SystemMessageItemParamRole: %v", v)
	}
}

type SystemMessageItemParamContent1Type string

const (
	SystemMessageItemParamContent1TypeInputTextContentParam SystemMessageItemParamContent1Type = "InputTextContentParam"
)

type SystemMessageItemParamContent1 struct {
	InputTextContentParam *InputTextContentParam `queryParam:"inline" union:"member"`

	Type SystemMessageItemParamContent1Type
}

func CreateSystemMessageItemParamContent1InputTextContentParam(inputTextContentParam InputTextContentParam) SystemMessageItemParamContent1 {
	typ := SystemMessageItemParamContent1TypeInputTextContentParam

	return SystemMessageItemParamContent1{
		InputTextContentParam: &inputTextContentParam,
		Type:                  typ,
	}
}

func (u *SystemMessageItemParamContent1) UnmarshalJSON(data []byte) error {

	var candidates []utils.UnionCandidate

	// Collect all valid candidates
	var inputTextContentParam InputTextContentParam = InputTextContentParam{}
	if err := utils.UnmarshalJSON(data, &inputTextContentParam, "", true, nil); err == nil {
		candidates = append(candidates, utils.UnionCandidate{
			Type:  SystemMessageItemParamContent1TypeInputTextContentParam,
			Value: &inputTextContentParam,
		})
	}

	if len(candidates) == 0 {
		return fmt.Errorf("could not unmarshal `%s` into any supported union types for SystemMessageItemParamContent1", string(data))
	}

	// Pick the best candidate using multi-stage filtering
	best := utils.PickBestUnionCandidate(candidates, data)
	if best == nil {
		return fmt.Errorf("could not unmarshal `%s` into any supported union types for SystemMessageItemParamContent1", string(data))
	}

	// Set the union type and value based on the best candidate
	u.Type = best.Type.(SystemMessageItemParamContent1Type)
	switch best.Type {
	case SystemMessageItemParamContent1TypeInputTextContentParam:
		u.InputTextContentParam = best.Value.(*InputTextContentParam)
		return nil
	}

	return fmt.Errorf("could not unmarshal `%s` into any supported union types for SystemMessageItemParamContent1", string(data))
}

func (u SystemMessageItemParamContent1) MarshalJSON() ([]byte, error) {
	if u.InputTextContentParam != nil {
		return utils.MarshalJSON(u.InputTextContentParam, "", true)
	}

	return nil, errors.New("could not marshal union type SystemMessageItemParamContent1: all fields are null")
}

type SystemMessageItemParamContent2Type string

const (
	SystemMessageItemParamContent2TypeArrayOfSystemMessageItemParamContent1 SystemMessageItemParamContent2Type = "arrayOfSystemMessageItemParamContent1"
	SystemMessageItemParamContent2TypeStr                                   SystemMessageItemParamContent2Type = "str"
)

// SystemMessageItemParamContent2 - The message content, as an array of content parts.
type SystemMessageItemParamContent2 struct {
	ArrayOfSystemMessageItemParamContent1 []SystemMessageItemParamContent1 `queryParam:"inline" union:"member"`
	Str                                   *string                          `queryParam:"inline" union:"member"`

	Type SystemMessageItemParamContent2Type
}

func CreateSystemMessageItemParamContent2ArrayOfSystemMessageItemParamContent1(arrayOfSystemMessageItemParamContent1 []SystemMessageItemParamContent1) SystemMessageItemParamContent2 {
	typ := SystemMessageItemParamContent2TypeArrayOfSystemMessageItemParamContent1

	return SystemMessageItemParamContent2{
		ArrayOfSystemMessageItemParamContent1: arrayOfSystemMessageItemParamContent1,
		Type:                                  typ,
	}
}

func CreateSystemMessageItemParamContent2Str(str string) SystemMessageItemParamContent2 {
	typ := SystemMessageItemParamContent2TypeStr

	return SystemMessageItemParamContent2{
		Str:  &str,
		Type: typ,
	}
}

func (u *SystemMessageItemParamContent2) UnmarshalJSON(data []byte) error {

	var candidates []utils.UnionCandidate

	// Collect all valid candidates
	var arrayOfSystemMessageItemParamContent1 []SystemMessageItemParamContent1 = []SystemMessageItemParamContent1{}
	if err := utils.UnmarshalJSON(data, &arrayOfSystemMessageItemParamContent1, "", true, nil); err == nil {
		candidates = append(candidates, utils.UnionCandidate{
			Type:  SystemMessageItemParamContent2TypeArrayOfSystemMessageItemParamContent1,
			Value: arrayOfSystemMessageItemParamContent1,
		})
	}

	var str string = ""
	if err := utils.UnmarshalJSON(data, &str, "", true, nil); err == nil {
		candidates = append(candidates, utils.UnionCandidate{
			Type:  SystemMessageItemParamContent2TypeStr,
			Value: &str,
		})
	}

	if len(candidates) == 0 {
		return fmt.Errorf("could not unmarshal `%s` into any supported union types for SystemMessageItemParamContent2", string(data))
	}

	// Pick the best candidate using multi-stage filtering
	best := utils.PickBestUnionCandidate(candidates, data)
	if best == nil {
		return fmt.Errorf("could not unmarshal `%s` into any supported union types for SystemMessageItemParamContent2", string(data))
	}

	// Set the union type and value based on the best candidate
	u.Type = best.Type.(SystemMessageItemParamContent2Type)
	switch best.Type {
	case SystemMessageItemParamContent2TypeArrayOfSystemMessageItemParamContent1:
		u.ArrayOfSystemMessageItemParamContent1 = best.Value.([]SystemMessageItemParamContent1)
		return nil
	case SystemMessageItemParamContent2TypeStr:
		u.Str = best.Value.(*string)
		return nil
	}

	return fmt.Errorf("could not unmarshal `%s` into any supported union types for SystemMessageItemParamContent2", string(data))
}

func (u SystemMessageItemParamContent2) MarshalJSON() ([]byte, error) {
	if u.ArrayOfSystemMessageItemParamContent1 != nil {
		return utils.MarshalJSON(u.ArrayOfSystemMessageItemParamContent1, "", true)
	}

	if u.Str != nil {
		return utils.MarshalJSON(u.Str, "", true)
	}

	return nil, errors.New("could not marshal union type SystemMessageItemParamContent2: all fields are null")
}

type SystemMessageItemParam struct {
	ID optionalnullable.OptionalNullable[string] `json:"id,omitzero"`
	// The item type. Always `message`.
	Type *SystemMessageItemParamType `default:"message" json:"type"`
	// The message role. Always `system`.
	Role *SystemMessageItemParamRole `default:"system" json:"role"`
	// The message content, as an array of content parts.
	Content SystemMessageItemParamContent2            `json:"content"`
	Status  optionalnullable.OptionalNullable[string] `json:"status,omitzero"`
}

func (s SystemMessageItemParam) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(s, "", false)
}

func (s *SystemMessageItemParam) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &s, "", false, nil); err != nil {
		return err
	}
	return nil
}

func (s *SystemMessageItemParam) GetID() optionalnullable.OptionalNullable[string] {
	if s == nil {
		return nil
	}
	return s.ID
}

func (s *SystemMessageItemParam) GetType() *SystemMessageItemParamType {
	if s == nil {
		return nil
	}
	return s.Type
}

func (s *SystemMessageItemParam) GetRole() *SystemMessageItemParamRole {
	if s == nil {
		return nil
	}
	return s.Role
}

func (s *SystemMessageItemParam) GetContent() SystemMessageItemParamContent2 {
	if s == nil {
		return SystemMessageItemParamContent2{}
	}
	return s.Content
}

func (s *SystemMessageItemParam) GetStatus() optionalnullable.OptionalNullable[string] {
	if s == nil {
		return nil
	}
	return s.Status
}
