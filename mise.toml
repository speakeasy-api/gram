# üí° TIP
#
# If you want to override anything in this file, create an adjacent file called
# `mise.local.toml`. That file is not checked in to the repository. Using this
# file, you can specify more tools or different version of listed ones below as
# well as overriding environment variables.
[tools]
"aqua:ariga/atlas" = "1.0.0"
"github:speakeasy-api/speakeasy" = "1.700.2"
"github:FiloSottile/mkcert" = "1.4.4"
apko = "1.1.3"
flyctl = "0.4.6"
go = "1.25.6"
golangci-lint = "2.8.0"
gomigrate = "4.19.1"
gum = "0.17.0"
jq = "1.8.1"
melange = "0.40.4"
nodejs = "24.10.0"
pnpm = "10.28.2"
watchexec = "2.3.3"
mprocs = "0.8.3"

# ‚ÑπÔ∏è The settings below are sensible defaults for local development. When
# deploying to production, you will want to configure these more carefully.
[env]
############################
## Database configuration ##
############################
## The following DB_* variables are only needed to configure the postgres local
## development database and to run SQLc (`mise run gen:sqlc-server`). They do
## not need to be set in a production deployment.
DB_USER = "gram"
DB_PASSWORD = "gram"
DB_NAME = "gram"
DB_HOST = "127.0.0.1"
DB_PORT = "5439"
## Only this variable is relevant to production deployments. It can be set to a
## static connection string. In this case, we use interpolation to point to the
## local development database configured above.
GRAM_DATABASE_URL = "postgres://{{env.DB_USER}}:{{env.DB_PASSWORD}}@{{env.DB_HOST}}:{{env.DB_PORT}}/{{env.DB_NAME}}?sslmode=disable&search_path=public"

##############################
## ClickHouse configuration ##
##############################
CLICKHOUSE_USERNAME = "gram"
CLICKHOUSE_PASSWORD = "gram"
CLICKHOUSE_HOST = "127.0.0.1"
CLICKHOUSE_NATIVE_PORT = "9440"
CLICKHOUSE_DATABASE = "default"
CLICKHOUSE_INSECURE = true
GRAM_CLICKHOUSE_URL = "clickhouse://{{env.CLICKHOUSE_USERNAME}}:{{env.CLICKHOUSE_PASSWORD}}@{{env.CLICKHOUSE_HOST}}:{{env.CLICKHOUSE_NATIVE_PORT}}/{{env.CLICKHOUSE_DATABASE}}?secure=true&skip_verify=true"
## golang-migrate requires username/password as query parameters instead of in the URL
GRAM_CLICKHOUSE_GOMIGRATE_URL = "clickhouse://{{env.CLICKHOUSE_HOST}}:{{env.CLICKHOUSE_NATIVE_PORT}}/{{env.CLICKHOUSE_DATABASE}}?username={{env.CLICKHOUSE_USERNAME}}&password={{env.CLICKHOUSE_PASSWORD}}&secure=true&skip_verify=true&x-multi-statement=true"

############################
## Temporal configuration ##
############################
TEMPORAL_PORT = "7233"
TEMPORAL_NAMESPACE = "default"
## When using Temporal Cloud, the following variable should like something like:
##     "<namespace>.<account>.tmprl.cloud:7233".
TEMPORAL_ADDRESS = ":{{env.TEMPORAL_PORT}}"

###################################
## Gram server and worker config ##
###################################
## Setting this to 1 will run the server and worker in a single process.
## This is useful when debugging during local development. It can also be used
## for simple production deployments although you are encouraged to run the gram
## server and worker as separate processes that can be scaled independently.
GRAM_SINGLE_PROCESS = 0
GRAM_SERVER_ADDRESS = ":8080"
GRAM_CONTROL_ADDRESS = ":8081"
GRAM_WORKER_CONTROL_ADDRESS = ":8082"
## The following variable can be one of: local, test, prod
GRAM_ENVIRONMENT = "local"
GRAM_SERVER_URL = "https://localhost:8080"
GRAM_SITE_URL = "https://localhost:5173"
GRAM_ASSETS_BACKEND = "fs"
GRAM_ASSETS_URI = ".assets"
## The following variable is used to encrypt env vars stored in the database.
GRAM_ENCRYPTION_KEY = "unset"
GRAM_REDIS_CACHE_ADDR = "127.0.0.1:5445"
GRAM_REDIS_CACHE_PASSWORD = "xi9XILbY"
OPENROUTER_DEV_KEY = "unset"
## The following two variables are used by Speakeasy staff developing against
## the Speakeasy app.
SPEAKEASY_SERVER_ADDRESS = "http://localhost:35291"
SPEAKEASY_SECRET_KEY = "unset"
## The following variables are only needed if you want to do one of the following:
## - Run the server with SSL enabled and not rely on SSL termination at a load balancer.
## - Local development with SSL enabled.
GRAM_SSL_CERT_FILE = "{{config_root}}/local/ssl/certs/local.pem"
GRAM_SSL_KEY_FILE = "{{config_root}}/local/ssl/keys/local-key.pem"

##########################
## Observability config ##
##########################
OTEL_EXPORTER_OTLP_ENDPOINT = "http://localhost:4317"
## Change these to 0 to disable OpenTelemetry traces and metrics to be emitted.
GRAM_ENABLE_OTEL_TRACES = 1
GRAM_ENABLE_OTEL_METRICS = 1

################################
## Local development settings ##
################################
GRAM_LOG_PRETTY = 1
## DO NOT SET THIS VARIABLE WHEN DEPLOYING TO PRODUCTION.
GRAM_UNSAFE_LOCAL_ENV_PATH = "{{config_root}}/.local.env.json"
## This config is used by the Elements SDK and CLI to point to the correct Gram
## API server
GRAM_API_URL = "{{env.GRAM_SERVER_URL}}"
VITE_DEV_HOSTNAMES = "localhost,gram.local"
TEMPORAL_WEB_PORT = "8233"
## The following variables configure the local opentelemetry stack
OTLP_GRPC_PORT = "4317"
## If you want to enable/disable certain feature flags during local development,
## copy the following line to mise.local.toml and point to a CSV file containing
## flag settings. Check out flags.local.csv.example in the root of the repo for
## an example of the format.
## For a list of feature flags, check `server/internal/feature/flags.go`.
# GRAM_LOCAL_FEATURE_FLAGS_CSV = "{{config_root}}/flags.csv"

####################################
## Gram Functions runner settings ##
####################################
## Where to deploy functions.
## Allowed values: local, flyio.
GRAM_FUNCTIONS_PROVIDER = "local"
GRAM_FUNCTIONS_RUNNER_OCI_IMAGE = "gram-runner"
## By default, the runner version is inferred from the version of the
## server/worker. If needed, you can pin the version with the following
## variable. You must ensure the required version is available for the given OCI
## image in ther registry.
# GRAM_FUNCTIONS_RUNNER_VERSION = ""
GRAM_FUNCTIONS_LOCAL_RUNNER_ROOT = "{{config_root}}/local/functions"
## fly.io api token for deploying gram function runners
# GRAM_FUNCTIONS_FLYIO_API_TOKEN = "unset"
## Default app for deploying fly.io apps
# GRAM_FUNCTIONS_FLYIO_ORG = "unset"
## Default region for deploying fly.io apps
# GRAM_FUNCTIONS_FLYIO_REGION = "sjc"

##################
## MCP Registry ##
##################
## Options below configure where your optional local registry container will be
## discoverable by the Gram application.
LOCAL_MCP_REGISTRY_PORT = "9847"
LOCAL_MCP_REGISTRY_URL = "http://localhost:{{env.LOCAL_MCP_REGISTRY_PORT}}"
PULSE_REGISTRY_TENANT = "unset"
PULSE_REGISTRY_KEY = "unset"

##############
## Elements ##
## Used for local development only
VITE_GRAM_ELEMENTS_STORYBOOK_URL = "https://localhost:6006"

# Loops transactional email API key. Set to a real key to enable invite emails locally.
LOOPS_API_KEY = "unset"
