/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import * as z from "zod";
import { remap as remap$ } from "../../lib/primitives.js";
import { safeParse } from "../../lib/schemas.js";
import { Result as SafeParseResult } from "../../types/fp.js";
import { SDKValidationError } from "../errors/sdkvalidationerror.js";
import {
  DeploymentExternalMCP,
  DeploymentExternalMCP$inboundSchema,
  DeploymentExternalMCP$Outbound,
  DeploymentExternalMCP$outboundSchema,
} from "./deploymentexternalmcp.js";
import {
  DeploymentFunctions,
  DeploymentFunctions$inboundSchema,
  DeploymentFunctions$Outbound,
  DeploymentFunctions$outboundSchema,
} from "./deploymentfunctions.js";
import {
  DeploymentPackage,
  DeploymentPackage$inboundSchema,
  DeploymentPackage$Outbound,
  DeploymentPackage$outboundSchema,
} from "./deploymentpackage.js";
import {
  OpenAPIv3DeploymentAsset,
  OpenAPIv3DeploymentAsset$inboundSchema,
  OpenAPIv3DeploymentAsset$Outbound,
  OpenAPIv3DeploymentAsset$outboundSchema,
} from "./openapiv3deploymentasset.js";

export type Deployment = {
  /**
   * The ID of the deployment that this deployment was cloned from.
   */
  clonedFrom?: string | undefined;
  /**
   * The creation date of the deployment.
   */
  createdAt: Date;
  /**
   * The external ID to refer to the deployment. This can be a git commit hash for example.
   */
  externalId?: string | undefined;
  /**
   * The external MCP servers that were deployed.
   */
  externalMcps?: Array<DeploymentExternalMCP> | undefined;
  /**
   * The upstream URL a deployment can refer to. This can be a github url to a commit hash or pull request.
   */
  externalUrl?: string | undefined;
  /**
   * The IDs, as returned from the assets upload service, to uploaded OpenAPI 3.x documents whose operations will become tool definitions.
   */
  functionsAssets?: Array<DeploymentFunctions> | undefined;
  /**
   * The number of tools in the deployment generated from OpenAPI documents.
   */
  functionsToolCount: number;
  /**
   * The github pull request that resulted in the deployment.
   */
  githubPr?: string | undefined;
  /**
   * The github repository in the form of "owner/repo".
   */
  githubRepo?: string | undefined;
  /**
   * The commit hash that triggered the deployment.
   */
  githubSha?: string | undefined;
  /**
   * The ID to of the deployment.
   */
  id: string;
  /**
   * A unique identifier that will mitigate against duplicate deployments.
   */
  idempotencyKey?: string | undefined;
  /**
   * The IDs, as returned from the assets upload service, to uploaded OpenAPI 3.x documents whose operations will become tool definitions.
   */
  openapiv3Assets: Array<OpenAPIv3DeploymentAsset>;
  /**
   * The number of tools in the deployment generated from OpenAPI documents.
   */
  openapiv3ToolCount: number;
  /**
   * The ID of the organization that the deployment belongs to.
   */
  organizationId: string;
  /**
   * The packages that were deployed.
   */
  packages: Array<DeploymentPackage>;
  /**
   * The ID of the project that the deployment belongs to.
   */
  projectId: string;
  /**
   * The status of the deployment.
   */
  status: string;
  /**
   * The ID of the user that created the deployment.
   */
  userId: string;
};

/** @internal */
export const Deployment$inboundSchema: z.ZodType<
  Deployment,
  z.ZodTypeDef,
  unknown
> = z.object({
  cloned_from: z.string().optional(),
  created_at: z.string().datetime({ offset: true }).transform(v => new Date(v)),
  external_id: z.string().optional(),
  external_mcps: z.array(DeploymentExternalMCP$inboundSchema).optional(),
  external_url: z.string().optional(),
  functions_assets: z.array(DeploymentFunctions$inboundSchema).optional(),
  functions_tool_count: z.number().int(),
  github_pr: z.string().optional(),
  github_repo: z.string().optional(),
  github_sha: z.string().optional(),
  id: z.string(),
  idempotency_key: z.string().optional(),
  openapiv3_assets: z.array(OpenAPIv3DeploymentAsset$inboundSchema),
  openapiv3_tool_count: z.number().int(),
  organization_id: z.string(),
  packages: z.array(DeploymentPackage$inboundSchema),
  project_id: z.string(),
  status: z.string(),
  user_id: z.string(),
}).transform((v) => {
  return remap$(v, {
    "cloned_from": "clonedFrom",
    "created_at": "createdAt",
    "external_id": "externalId",
    "external_mcps": "externalMcps",
    "external_url": "externalUrl",
    "functions_assets": "functionsAssets",
    "functions_tool_count": "functionsToolCount",
    "github_pr": "githubPr",
    "github_repo": "githubRepo",
    "github_sha": "githubSha",
    "idempotency_key": "idempotencyKey",
    "openapiv3_assets": "openapiv3Assets",
    "openapiv3_tool_count": "openapiv3ToolCount",
    "organization_id": "organizationId",
    "project_id": "projectId",
    "user_id": "userId",
  });
});

/** @internal */
export type Deployment$Outbound = {
  cloned_from?: string | undefined;
  created_at: string;
  external_id?: string | undefined;
  external_mcps?: Array<DeploymentExternalMCP$Outbound> | undefined;
  external_url?: string | undefined;
  functions_assets?: Array<DeploymentFunctions$Outbound> | undefined;
  functions_tool_count: number;
  github_pr?: string | undefined;
  github_repo?: string | undefined;
  github_sha?: string | undefined;
  id: string;
  idempotency_key?: string | undefined;
  openapiv3_assets: Array<OpenAPIv3DeploymentAsset$Outbound>;
  openapiv3_tool_count: number;
  organization_id: string;
  packages: Array<DeploymentPackage$Outbound>;
  project_id: string;
  status: string;
  user_id: string;
};

/** @internal */
export const Deployment$outboundSchema: z.ZodType<
  Deployment$Outbound,
  z.ZodTypeDef,
  Deployment
> = z.object({
  clonedFrom: z.string().optional(),
  createdAt: z.date().transform(v => v.toISOString()),
  externalId: z.string().optional(),
  externalMcps: z.array(DeploymentExternalMCP$outboundSchema).optional(),
  externalUrl: z.string().optional(),
  functionsAssets: z.array(DeploymentFunctions$outboundSchema).optional(),
  functionsToolCount: z.number().int(),
  githubPr: z.string().optional(),
  githubRepo: z.string().optional(),
  githubSha: z.string().optional(),
  id: z.string(),
  idempotencyKey: z.string().optional(),
  openapiv3Assets: z.array(OpenAPIv3DeploymentAsset$outboundSchema),
  openapiv3ToolCount: z.number().int(),
  organizationId: z.string(),
  packages: z.array(DeploymentPackage$outboundSchema),
  projectId: z.string(),
  status: z.string(),
  userId: z.string(),
}).transform((v) => {
  return remap$(v, {
    clonedFrom: "cloned_from",
    createdAt: "created_at",
    externalId: "external_id",
    externalMcps: "external_mcps",
    externalUrl: "external_url",
    functionsAssets: "functions_assets",
    functionsToolCount: "functions_tool_count",
    githubPr: "github_pr",
    githubRepo: "github_repo",
    githubSha: "github_sha",
    idempotencyKey: "idempotency_key",
    openapiv3Assets: "openapiv3_assets",
    openapiv3ToolCount: "openapiv3_tool_count",
    organizationId: "organization_id",
    projectId: "project_id",
    userId: "user_id",
  });
});

/**
 * @internal
 * @deprecated This namespace will be removed in future versions. Use schemas and types that are exported directly from this module.
 */
export namespace Deployment$ {
  /** @deprecated use `Deployment$inboundSchema` instead. */
  export const inboundSchema = Deployment$inboundSchema;
  /** @deprecated use `Deployment$outboundSchema` instead. */
  export const outboundSchema = Deployment$outboundSchema;
  /** @deprecated use `Deployment$Outbound` instead. */
  export type Outbound = Deployment$Outbound;
}

export function deploymentToJSON(deployment: Deployment): string {
  return JSON.stringify(Deployment$outboundSchema.parse(deployment));
}

export function deploymentFromJSON(
  jsonString: string,
): SafeParseResult<Deployment, SDKValidationError> {
  return safeParse(
    jsonString,
    (x) => Deployment$inboundSchema.parse(JSON.parse(x)),
    `Failed to parse 'Deployment' from JSON`,
  );
}
