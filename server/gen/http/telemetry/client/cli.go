// Code generated by goa v3.24.1, DO NOT EDIT.
//
// telemetry HTTP client CLI support package
//
// Command:
// $ goa gen github.com/speakeasy-api/gram/server/design

package client

import (
	"encoding/json"
	"fmt"
	"unicode/utf8"

	telemetry "github.com/speakeasy-api/gram/server/gen/telemetry"
	goa "goa.design/goa/v3/pkg"
)

// BuildSearchLogsPayload builds the payload for the telemetry searchLogs
// endpoint from CLI flags.
func BuildSearchLogsPayload(telemetrySearchLogsBody string, telemetrySearchLogsApikeyToken string, telemetrySearchLogsSessionToken string, telemetrySearchLogsProjectSlugInput string) (*telemetry.SearchLogsPayload, error) {
	var err error
	var body SearchLogsRequestBody
	{
		err = json.Unmarshal([]byte(telemetrySearchLogsBody), &body)
		if err != nil {
			return nil, fmt.Errorf("invalid JSON for body, \nerror: %s, \nexample of valid JSON:\n%s", err, "'{\n      \"cursor\": \"Itaque possimus magni facere sit eos fugit.\",\n      \"filter\": {\n         \"deployment_id\": \"d7d1d6f8-f6e5-41a3-aaa1-a86cc69c48ff\",\n         \"from\": \"2025-12-19T10:00:00Z\",\n         \"function_id\": \"b4563531-d896-47f2-b6fa-9671ef405490\",\n         \"gram_urn\": \"Quam qui blanditiis corrupti quo qui.\",\n         \"gram_urns\": [\n            \"Aliquid neque numquam quibusdam.\",\n            \"Dignissimos vitae enim consequatur molestiae est ut.\",\n            \"Quaerat similique quia dolorum natus quam excepturi.\",\n            \"Dolores est perspiciatis doloribus nihil consequuntur.\"\n         ],\n         \"http_method\": \"GET\",\n         \"http_route\": \"Possimus quam ipsa.\",\n         \"http_status_code\": 1818692963,\n         \"service_name\": \"At aut omnis et praesentium.\",\n         \"severity_text\": \"ERROR\",\n         \"to\": \"2025-12-19T11:00:00Z\",\n         \"trace_id\": \"549b97971c898de0b135f23a65064980\"\n      },\n      \"limit\": 785,\n      \"sort\": \"desc\"\n   }'")
		}
	}
	var apikeyToken *string
	{
		if telemetrySearchLogsApikeyToken != "" {
			apikeyToken = &telemetrySearchLogsApikeyToken
		}
	}
	var sessionToken *string
	{
		if telemetrySearchLogsSessionToken != "" {
			sessionToken = &telemetrySearchLogsSessionToken
		}
	}
	var projectSlugInput *string
	{
		if telemetrySearchLogsProjectSlugInput != "" {
			projectSlugInput = &telemetrySearchLogsProjectSlugInput
		}
	}
	v := &telemetry.SearchLogsPayload{
		Cursor: body.Cursor,
		Sort:   body.Sort,
		Limit:  body.Limit,
	}
	if body.Filter != nil {
		v.Filter = marshalSearchLogsFilterRequestBodyToTelemetrySearchLogsFilter(body.Filter)
	}
	{
		var zero string
		if v.Sort == zero {
			v.Sort = "desc"
		}
	}
	{
		var zero int
		if v.Limit == zero {
			v.Limit = 50
		}
	}
	v.ApikeyToken = apikeyToken
	v.SessionToken = sessionToken
	v.ProjectSlugInput = projectSlugInput

	return v, nil
}

// BuildSearchToolCallsPayload builds the payload for the telemetry
// searchToolCalls endpoint from CLI flags.
func BuildSearchToolCallsPayload(telemetrySearchToolCallsBody string, telemetrySearchToolCallsApikeyToken string, telemetrySearchToolCallsSessionToken string, telemetrySearchToolCallsProjectSlugInput string) (*telemetry.SearchToolCallsPayload, error) {
	var err error
	var body SearchToolCallsRequestBody
	{
		err = json.Unmarshal([]byte(telemetrySearchToolCallsBody), &body)
		if err != nil {
			return nil, fmt.Errorf("invalid JSON for body, \nerror: %s, \nexample of valid JSON:\n%s", err, "'{\n      \"cursor\": \"Quo perferendis et molestiae ut praesentium.\",\n      \"filter\": {\n         \"deployment_id\": \"c7d87071-4044-4b3b-b3d4-1d3abee50fb3\",\n         \"from\": \"2025-12-19T10:00:00Z\",\n         \"function_id\": \"211a852d-1621-4b7b-9818-d2f1dbb68225\",\n         \"gram_urn\": \"Sed repellendus numquam nihil sint.\",\n         \"to\": \"2025-12-19T11:00:00Z\"\n      },\n      \"limit\": 109,\n      \"sort\": \"asc\"\n   }'")
		}
	}
	var apikeyToken *string
	{
		if telemetrySearchToolCallsApikeyToken != "" {
			apikeyToken = &telemetrySearchToolCallsApikeyToken
		}
	}
	var sessionToken *string
	{
		if telemetrySearchToolCallsSessionToken != "" {
			sessionToken = &telemetrySearchToolCallsSessionToken
		}
	}
	var projectSlugInput *string
	{
		if telemetrySearchToolCallsProjectSlugInput != "" {
			projectSlugInput = &telemetrySearchToolCallsProjectSlugInput
		}
	}
	v := &telemetry.SearchToolCallsPayload{
		Cursor: body.Cursor,
		Sort:   body.Sort,
		Limit:  body.Limit,
	}
	if body.Filter != nil {
		v.Filter = marshalSearchToolCallsFilterRequestBodyToTelemetrySearchToolCallsFilter(body.Filter)
	}
	{
		var zero string
		if v.Sort == zero {
			v.Sort = "desc"
		}
	}
	{
		var zero int
		if v.Limit == zero {
			v.Limit = 50
		}
	}
	v.ApikeyToken = apikeyToken
	v.SessionToken = sessionToken
	v.ProjectSlugInput = projectSlugInput

	return v, nil
}

// BuildCaptureEventPayload builds the payload for the telemetry captureEvent
// endpoint from CLI flags.
func BuildCaptureEventPayload(telemetryCaptureEventBody string, telemetryCaptureEventApikeyToken string, telemetryCaptureEventSessionToken string, telemetryCaptureEventProjectSlugInput string, telemetryCaptureEventChatSessionsToken string) (*telemetry.CaptureEventPayload, error) {
	var err error
	var body CaptureEventRequestBody
	{
		err = json.Unmarshal([]byte(telemetryCaptureEventBody), &body)
		if err != nil {
			return nil, fmt.Errorf("invalid JSON for body, \nerror: %s, \nexample of valid JSON:\n%s", err, "'{\n      \"distinct_id\": \"Possimus ab eligendi voluptas possimus consequuntur dolorem.\",\n      \"event\": \"button_clicked\",\n      \"properties\": {\n         \"button_name\": \"submit\",\n         \"page\": \"checkout\",\n         \"value\": 100\n      }\n   }'")
		}
		if utf8.RuneCountInString(body.Event) < 1 {
			err = goa.MergeErrors(err, goa.InvalidLengthError("body.event", body.Event, utf8.RuneCountInString(body.Event), 1, true))
		}
		if utf8.RuneCountInString(body.Event) > 255 {
			err = goa.MergeErrors(err, goa.InvalidLengthError("body.event", body.Event, utf8.RuneCountInString(body.Event), 255, false))
		}
		if err != nil {
			return nil, err
		}
	}
	var apikeyToken *string
	{
		if telemetryCaptureEventApikeyToken != "" {
			apikeyToken = &telemetryCaptureEventApikeyToken
		}
	}
	var sessionToken *string
	{
		if telemetryCaptureEventSessionToken != "" {
			sessionToken = &telemetryCaptureEventSessionToken
		}
	}
	var projectSlugInput *string
	{
		if telemetryCaptureEventProjectSlugInput != "" {
			projectSlugInput = &telemetryCaptureEventProjectSlugInput
		}
	}
	var chatSessionsToken *string
	{
		if telemetryCaptureEventChatSessionsToken != "" {
			chatSessionsToken = &telemetryCaptureEventChatSessionsToken
		}
	}
	v := &telemetry.CaptureEventPayload{
		Event:      body.Event,
		DistinctID: body.DistinctID,
	}
	if body.Properties != nil {
		v.Properties = make(map[string]any, len(body.Properties))
		for key, val := range body.Properties {
			tk := key
			tv := val
			v.Properties[tk] = tv
		}
	}
	v.ApikeyToken = apikeyToken
	v.SessionToken = sessionToken
	v.ProjectSlugInput = projectSlugInput
	v.ChatSessionsToken = chatSessionsToken

	return v, nil
}

// BuildGetMetricsSummaryPayload builds the payload for the telemetry
// getMetricsSummary endpoint from CLI flags.
func BuildGetMetricsSummaryPayload(telemetryGetMetricsSummaryBody string, telemetryGetMetricsSummaryApikeyToken string, telemetryGetMetricsSummarySessionToken string, telemetryGetMetricsSummaryProjectSlugInput string) (*telemetry.GetMetricsSummaryPayload, error) {
	var err error
	var body GetMetricsSummaryRequestBody
	{
		err = json.Unmarshal([]byte(telemetryGetMetricsSummaryBody), &body)
		if err != nil {
			return nil, fmt.Errorf("invalid JSON for body, \nerror: %s, \nexample of valid JSON:\n%s", err, "'{\n      \"chat_id\": \"36186f3d-a708-4d70-bcbc-345329168b84\",\n      \"deployment_id\": \"970ee97b-02aa-4a1e-9007-a087b74a0e31\",\n      \"from\": \"2025-12-19T10:00:00Z\",\n      \"scope\": \"chat\",\n      \"to\": \"2025-12-19T11:00:00Z\"\n   }'")
		}
		if !(body.Scope == "project" || body.Scope == "chat") {
			err = goa.MergeErrors(err, goa.InvalidEnumValueError("body.scope", body.Scope, []any{"project", "chat"}))
		}
		err = goa.MergeErrors(err, goa.ValidateFormat("body.from", body.From, goa.FormatDateTime))
		err = goa.MergeErrors(err, goa.ValidateFormat("body.to", body.To, goa.FormatDateTime))
		if body.ChatID != nil {
			err = goa.MergeErrors(err, goa.ValidateFormat("body.chat_id", *body.ChatID, goa.FormatUUID))
		}
		if body.DeploymentID != nil {
			err = goa.MergeErrors(err, goa.ValidateFormat("body.deployment_id", *body.DeploymentID, goa.FormatUUID))
		}
		if err != nil {
			return nil, err
		}
	}
	var apikeyToken *string
	{
		if telemetryGetMetricsSummaryApikeyToken != "" {
			apikeyToken = &telemetryGetMetricsSummaryApikeyToken
		}
	}
	var sessionToken *string
	{
		if telemetryGetMetricsSummarySessionToken != "" {
			sessionToken = &telemetryGetMetricsSummarySessionToken
		}
	}
	var projectSlugInput *string
	{
		if telemetryGetMetricsSummaryProjectSlugInput != "" {
			projectSlugInput = &telemetryGetMetricsSummaryProjectSlugInput
		}
	}
	v := &telemetry.GetMetricsSummaryPayload{
		Scope:        telemetry.MetricsScope(body.Scope),
		From:         body.From,
		To:           body.To,
		ChatID:       body.ChatID,
		DeploymentID: body.DeploymentID,
	}
	v.ApikeyToken = apikeyToken
	v.SessionToken = sessionToken
	v.ProjectSlugInput = projectSlugInput

	return v, nil
}
