// Code generated by goa v3.24.2, DO NOT EDIT.
//
// telemetry service
//
// Command:
// $ goa gen github.com/speakeasy-api/gram/server/design

package telemetry

import (
	"context"

	goa "goa.design/goa/v3/pkg"
	"goa.design/goa/v3/security"
)

// Fetch telemetry data for tools in Gram.
type Service interface {
	// Search and list telemetry logs that match a search filter
	SearchLogs(context.Context, *SearchLogsPayload) (res *SearchLogsResult, err error)
	// Search and list tool calls that match a search filter
	SearchToolCalls(context.Context, *SearchToolCallsPayload) (res *SearchToolCallsResult, err error)
	// Search and list chat session summaries that match a search filter
	SearchChats(context.Context, *SearchChatsPayload) (res *SearchChatsResult, err error)
	// Capture a telemetry event and forward it to PostHog
	CaptureEvent(context.Context, *CaptureEventPayload) (res *CaptureEventResult, err error)
	// Get aggregated metrics summary for an entire project
	GetProjectMetricsSummary(context.Context, *GetProjectMetricsSummaryPayload) (res *GetMetricsSummaryResult, err error)
	// Get aggregated metrics summary grouped by user
	GetUserMetricsSummary(context.Context, *GetUserMetricsSummaryPayload) (res *GetUserMetricsSummaryResult, err error)
	// Get observability overview metrics including time series, tool breakdowns,
	// and summary stats
	GetObservabilityOverview(context.Context, *GetObservabilityOverviewPayload) (res *GetObservabilityOverviewResult, err error)
	// List available filter options (API keys or users) for the observability
	// overview
	ListFilterOptions(context.Context, *ListFilterOptionsPayload) (res *ListFilterOptionsResult, err error)
}

// Auther defines the authorization functions to be implemented by the service.
type Auther interface {
	// APIKeyAuth implements the authorization logic for the APIKey security scheme.
	APIKeyAuth(ctx context.Context, key string, schema *security.APIKeyScheme) (context.Context, error)
	// JWTAuth implements the authorization logic for the JWT security scheme.
	JWTAuth(ctx context.Context, token string, schema *security.JWTScheme) (context.Context, error)
}

// APIName is the name of the API as defined in the design.
const APIName = "gram"

// APIVersion is the version of the API as defined in the design.
const APIVersion = "0.0.1"

// ServiceName is the name of the service as defined in the design. This is the
// same value that is set in the endpoint request contexts under the ServiceKey
// key.
const ServiceName = "telemetry"

// MethodNames lists the service method names as defined in the design. These
// are the same values that are set in the endpoint request contexts under the
// MethodKey key.
var MethodNames = [8]string{"searchLogs", "searchToolCalls", "searchChats", "captureEvent", "getProjectMetricsSummary", "getUserMetricsSummary", "getObservabilityOverview", "listFilterOptions"}

// CaptureEventPayload is the payload type of the telemetry service
// captureEvent method.
type CaptureEventPayload struct {
	ApikeyToken       *string
	SessionToken      *string
	ProjectSlugInput  *string
	ChatSessionsToken *string
	// Event name
	Event string
	// Distinct ID for the user or entity (defaults to organization ID if not
	// provided)
	DistinctID *string
	// Event properties as key-value pairs
	Properties map[string]any
}

// CaptureEventResult is the result type of the telemetry service captureEvent
// method.
type CaptureEventResult struct {
	// Whether the event was successfully captured
	Success bool
}

// Summary information for a chat session
type ChatSummary struct {
	// Chat session ID
	GramChatID string
	// Earliest log timestamp in Unix nanoseconds
	StartTimeUnixNano int64
	// Latest log timestamp in Unix nanoseconds
	EndTimeUnixNano int64
	// Total number of logs in this chat session
	LogCount uint64
	// Number of tool calls in this chat session
	ToolCallCount uint64
	// Number of LLM completion messages in this chat session
	MessageCount uint64
	// Chat session duration in seconds
	DurationSeconds float64
	// Chat session status
	Status string
	// User ID associated with this chat session
	UserID *string
	// LLM model used in this chat session
	Model *string
	// Total input tokens used
	TotalInputTokens int64
	// Total output tokens used
	TotalOutputTokens int64
	// Total tokens used (input + output)
	TotalTokens int64
}

// A single filter option (API key or user)
type FilterOption struct {
	// Unique identifier for the option
	ID string
	// Display label for the option
	Label string
	// Number of events for this option
	Count int64
}

// GetMetricsSummaryResult is the result type of the telemetry service
// getProjectMetricsSummary method.
type GetMetricsSummaryResult struct {
	// Aggregated metrics
	Metrics *Metrics
	// Whether telemetry is enabled for the organization
	Enabled bool
}

// GetObservabilityOverviewPayload is the payload type of the telemetry service
// getObservabilityOverview method.
type GetObservabilityOverviewPayload struct {
	ApikeyToken      *string
	SessionToken     *string
	ProjectSlugInput *string
	// Start time in ISO 8601 format
	From string
	// End time in ISO 8601 format
	To string
	// Optional external user ID filter
	ExternalUserID *string
	// Optional API key ID filter
	APIKeyID *string
	// Whether to include time series data (default: true)
	IncludeTimeSeries bool
}

// GetObservabilityOverviewResult is the result type of the telemetry service
// getObservabilityOverview method.
type GetObservabilityOverviewResult struct {
	// Current period summary metrics
	Summary *ObservabilitySummary
	// Previous period summary metrics for trend calculation
	Comparison *ObservabilitySummary
	// Time series data points
	TimeSeries []*TimeSeriesBucket
	// Top tools by call count
	TopToolsByCount []*ToolMetric
	// Top tools by failure rate
	TopToolsByFailureRate []*ToolMetric
	// Whether telemetry is enabled for the organization
	Enabled bool
}

// GetProjectMetricsSummaryPayload is the payload type of the telemetry service
// getProjectMetricsSummary method.
type GetProjectMetricsSummaryPayload struct {
	ApikeyToken      *string
	SessionToken     *string
	ProjectSlugInput *string
	// Start time in ISO 8601 format
	From string
	// End time in ISO 8601 format
	To string
}

// GetUserMetricsSummaryPayload is the payload type of the telemetry service
// getUserMetricsSummary method.
type GetUserMetricsSummaryPayload struct {
	ApikeyToken      *string
	SessionToken     *string
	ProjectSlugInput *string
	// Start time in ISO 8601 format
	From string
	// End time in ISO 8601 format
	To string
	// User ID to get metrics for (mutually exclusive with external_user_id)
	UserID *string
	// External user ID to get metrics for (mutually exclusive with user_id)
	ExternalUserID *string
}

// GetUserMetricsSummaryResult is the result type of the telemetry service
// getUserMetricsSummary method.
type GetUserMetricsSummaryResult struct {
	// Aggregated metrics for the user
	Metrics *Metrics
	// Whether telemetry is enabled for the organization
	Enabled bool
}

// ListFilterOptionsPayload is the payload type of the telemetry service
// listFilterOptions method.
type ListFilterOptionsPayload struct {
	ApikeyToken      *string
	SessionToken     *string
	ProjectSlugInput *string
	// Start time in ISO 8601 format
	From string
	// End time in ISO 8601 format
	To string
	// Type of filter to list options for
	FilterType string
}

// ListFilterOptionsResult is the result type of the telemetry service
// listFilterOptions method.
type ListFilterOptionsResult struct {
	// List of filter options
	Options []*FilterOption
	// Whether telemetry is enabled for the organization
	Enabled bool
}

// Aggregated metrics
type Metrics struct {
	// Earliest activity timestamp in Unix nanoseconds
	FirstSeenUnixNano string
	// Latest activity timestamp in Unix nanoseconds
	LastSeenUnixNano string
	// Sum of input tokens used
	TotalInputTokens int64
	// Sum of output tokens used
	TotalOutputTokens int64
	// Sum of all tokens used
	TotalTokens int64
	// Average tokens per chat request
	AvgTokensPerRequest float64
	// Total number of chat requests
	TotalChatRequests int64
	// Average chat request duration in milliseconds
	AvgChatDurationMs float64
	// Requests that completed naturally
	FinishReasonStop int64
	// Requests that resulted in tool calls
	FinishReasonToolCalls int64
	// Total number of tool calls
	TotalToolCalls int64
	// Successful tool calls (2xx status)
	ToolCallSuccess int64
	// Failed tool calls (4xx/5xx status)
	ToolCallFailure int64
	// Average tool call duration in milliseconds
	AvgToolDurationMs float64
	// Number of unique chat sessions (project scope only)
	TotalChats int64
	// Number of distinct models used (project scope only)
	DistinctModels int64
	// Number of distinct providers used (project scope only)
	DistinctProviders int64
	// List of models used with call counts
	Models []*ModelUsage
	// List of tools used with success/failure counts
	Tools []*ToolUsage
}

// Model usage statistics
type ModelUsage struct {
	// Model name
	Name string
	// Number of times used
	Count int64
}

// Aggregated summary metrics for a time period
type ObservabilitySummary struct {
	// Total number of chat sessions
	TotalChats int64
	// Number of resolved chat sessions
	ResolvedChats int64
	// Number of failed chat sessions
	FailedChats int64
	// Average session duration in milliseconds
	AvgSessionDurationMs float64
	// Average time to resolution in milliseconds
	AvgResolutionTimeMs float64
	// Total number of tool calls
	TotalToolCalls int64
	// Number of failed tool calls
	FailedToolCalls int64
	// Average tool latency in milliseconds
	AvgLatencyMs float64
}

// Filter criteria for searching chat sessions
type SearchChatsFilter struct {
	// Start time in ISO 8601 format (e.g., '2025-12-19T10:00:00Z')
	From *string
	// End time in ISO 8601 format (e.g., '2025-12-19T11:00:00Z')
	To *string
	// Deployment ID filter
	DeploymentID *string
	// Gram URN filter (single URN, use gram_urns for multiple)
	GramUrn *string
	// User ID filter
	UserID *string
	// External user ID filter
	ExternalUserID *string
}

// SearchChatsPayload is the payload type of the telemetry service searchChats
// method.
type SearchChatsPayload struct {
	ApikeyToken      *string
	SessionToken     *string
	ProjectSlugInput *string
	// Filter criteria for the search
	Filter *SearchChatsFilter
	// Cursor for pagination
	Cursor *string
	// Sort order
	Sort string
	// Number of items to return (1-1000)
	Limit int
}

// SearchChatsResult is the result type of the telemetry service searchChats
// method.
type SearchChatsResult struct {
	// List of chat session summaries
	Chats []*ChatSummary
	// Cursor for next page
	NextCursor *string
	// Whether tool metrics are enabled for the organization
	Enabled bool
}

// Filter criteria for searching logs
type SearchLogsFilter struct {
	// Trace ID filter (32 hex characters)
	TraceID *string
	// Severity level filter
	SeverityText *string
	// HTTP status code filter
	HTTPStatusCode *int32
	// HTTP route filter
	HTTPRoute *string
	// HTTP method filter
	HTTPMethod *string
	// Service name filter
	ServiceName *string
	// Gram URN filter (one or more URNs)
	GramUrns []string
	// Chat ID filter
	GramChatID *string
	// User ID filter
	UserID *string
	// External user ID filter
	ExternalUserID *string
	// Start time in ISO 8601 format (e.g., '2025-12-19T10:00:00Z')
	From *string
	// End time in ISO 8601 format (e.g., '2025-12-19T11:00:00Z')
	To *string
	// Deployment ID filter
	DeploymentID *string
	// Function ID filter
	FunctionID *string
	// Gram URN filter (single URN, use gram_urns for multiple)
	GramUrn *string
}

// SearchLogsPayload is the payload type of the telemetry service searchLogs
// method.
type SearchLogsPayload struct {
	ApikeyToken      *string
	SessionToken     *string
	ProjectSlugInput *string
	// Filter criteria for the search
	Filter *SearchLogsFilter
	// Cursor for pagination
	Cursor *string
	// Sort order
	Sort string
	// Number of items to return (1-1000)
	Limit int
}

// SearchLogsResult is the result type of the telemetry service searchLogs
// method.
type SearchLogsResult struct {
	// List of telemetry log records
	Logs []*TelemetryLogRecord
	// Cursor for next page
	NextCursor *string
	// Whether tool metrics are enabled for the organization
	Enabled bool
}

// Filter criteria for searching tool calls
type SearchToolCallsFilter struct {
	// Start time in ISO 8601 format (e.g., '2025-12-19T10:00:00Z')
	From *string
	// End time in ISO 8601 format (e.g., '2025-12-19T11:00:00Z')
	To *string
	// Deployment ID filter
	DeploymentID *string
	// Function ID filter
	FunctionID *string
	// Gram URN filter (single URN, use gram_urns for multiple)
	GramUrn *string
}

// SearchToolCallsPayload is the payload type of the telemetry service
// searchToolCalls method.
type SearchToolCallsPayload struct {
	ApikeyToken      *string
	SessionToken     *string
	ProjectSlugInput *string
	// Filter criteria for the search
	Filter *SearchToolCallsFilter
	// Cursor for pagination
	Cursor *string
	// Sort order
	Sort string
	// Number of items to return (1-1000)
	Limit int
}

// SearchToolCallsResult is the result type of the telemetry service
// searchToolCalls method.
type SearchToolCallsResult struct {
	// List of tool call summaries
	ToolCalls []*ToolCallSummary
	// Cursor for next page
	NextCursor *string
	// Whether tool metrics are enabled for the organization
	Enabled bool
}

// Service information
type ServiceInfo struct {
	// Service name
	Name string
	// Service version
	Version *string
}

// OpenTelemetry log record
type TelemetryLogRecord struct {
	// Log record ID
	ID string
	// Unix time in nanoseconds when event occurred
	TimeUnixNano int64
	// Unix time in nanoseconds when event was observed
	ObservedTimeUnixNano int64
	// Text representation of severity
	SeverityText *string
	// The primary log message
	Body string
	// W3C trace ID (32 hex characters)
	TraceID *string
	// W3C span ID (16 hex characters)
	SpanID *string
	// Log attributes as JSON object
	Attributes any
	// Resource attributes as JSON object
	ResourceAttributes any
	// Service information
	Service *ServiceInfo
}

// A single time bucket for time series metrics
type TimeSeriesBucket struct {
	// Bucket start time in Unix nanoseconds (string for JS precision)
	BucketTimeUnixNano string
	// Total chat sessions in this bucket
	TotalChats int64
	// Resolved chat sessions in this bucket
	ResolvedChats int64
	// Failed chat sessions in this bucket
	FailedChats int64
	// Partially resolved chat sessions in this bucket
	PartialChats int64
	// Abandoned chat sessions in this bucket
	AbandonedChats int64
	// Total tool calls in this bucket
	TotalToolCalls int64
	// Failed tool calls in this bucket
	FailedToolCalls int64
	// Average tool latency in milliseconds
	AvgToolLatencyMs float64
	// Average session duration in milliseconds
	AvgSessionDurationMs float64
}

// Summary information for a tool call
type ToolCallSummary struct {
	// Trace ID (32 hex characters)
	TraceID string
	// Earliest log timestamp in Unix nanoseconds
	StartTimeUnixNano int64
	// Total number of logs in this tool call
	LogCount uint64
	// HTTP status code (if applicable)
	HTTPStatusCode *int32
	// Gram URN associated with this tool call
	GramUrn string
}

// Aggregated metrics for a single tool
type ToolMetric struct {
	// Tool URN
	GramUrn string
	// Total number of calls
	CallCount int64
	// Number of successful calls
	SuccessCount int64
	// Number of failed calls
	FailureCount int64
	// Average latency in milliseconds
	AvgLatencyMs float64
	// Failure rate (0.0 to 1.0)
	FailureRate float64
}

// Tool usage statistics
type ToolUsage struct {
	// Tool URN
	Urn string
	// Total call count
	Count int64
	// Successful calls (2xx status)
	SuccessCount int64
	// Failed calls (4xx/5xx status)
	FailureCount int64
}

// MakeUnauthorized builds a goa.ServiceError from an error.
func MakeUnauthorized(err error) *goa.ServiceError {
	return goa.NewServiceError(err, "unauthorized", false, false, false)
}

// MakeForbidden builds a goa.ServiceError from an error.
func MakeForbidden(err error) *goa.ServiceError {
	return goa.NewServiceError(err, "forbidden", false, false, false)
}

// MakeBadRequest builds a goa.ServiceError from an error.
func MakeBadRequest(err error) *goa.ServiceError {
	return goa.NewServiceError(err, "bad_request", false, false, false)
}

// MakeNotFound builds a goa.ServiceError from an error.
func MakeNotFound(err error) *goa.ServiceError {
	return goa.NewServiceError(err, "not_found", false, false, false)
}

// MakeConflict builds a goa.ServiceError from an error.
func MakeConflict(err error) *goa.ServiceError {
	return goa.NewServiceError(err, "conflict", false, false, false)
}

// MakeUnsupportedMedia builds a goa.ServiceError from an error.
func MakeUnsupportedMedia(err error) *goa.ServiceError {
	return goa.NewServiceError(err, "unsupported_media", false, false, false)
}

// MakeInvalid builds a goa.ServiceError from an error.
func MakeInvalid(err error) *goa.ServiceError {
	return goa.NewServiceError(err, "invalid", false, false, false)
}

// MakeInvariantViolation builds a goa.ServiceError from an error.
func MakeInvariantViolation(err error) *goa.ServiceError {
	return goa.NewServiceError(err, "invariant_violation", false, false, true)
}

// MakeUnexpected builds a goa.ServiceError from an error.
func MakeUnexpected(err error) *goa.ServiceError {
	return goa.NewServiceError(err, "unexpected", false, false, true)
}

// MakeGatewayError builds a goa.ServiceError from an error.
func MakeGatewayError(err error) *goa.ServiceError {
	return goa.NewServiceError(err, "gateway_error", false, false, true)
}
