// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.29.0
// source: queries.sql

package repo

import (
	"context"

	"github.com/google/uuid"
	"github.com/jackc/pgx/v5/pgtype"
)

const deleteAllEnvironmentConfigs = `-- name: DeleteAllEnvironmentConfigs :exec
DELETE FROM mcp_environment_configs
WHERE mcp_metadata_id = $1
`

func (q *Queries) DeleteAllEnvironmentConfigs(ctx context.Context, mcpMetadataID uuid.UUID) error {
	_, err := q.db.Exec(ctx, deleteAllEnvironmentConfigs, mcpMetadataID)
	return err
}

const deleteEnvironmentConfig = `-- name: DeleteEnvironmentConfig :exec
DELETE FROM mcp_environment_configs
WHERE mcp_metadata_id = $1
  AND variable_name = $2
`

type DeleteEnvironmentConfigParams struct {
	McpMetadataID uuid.UUID
	VariableName  string
}

func (q *Queries) DeleteEnvironmentConfig(ctx context.Context, arg DeleteEnvironmentConfigParams) error {
	_, err := q.db.Exec(ctx, deleteEnvironmentConfig, arg.McpMetadataID, arg.VariableName)
	return err
}

const getHeaderDisplayNames = `-- name: GetHeaderDisplayNames :one
SELECT header_display_names
FROM mcp_metadata
WHERE toolset_id = $1
`

func (q *Queries) GetHeaderDisplayNames(ctx context.Context, toolsetID uuid.UUID) ([]byte, error) {
	row := q.db.QueryRow(ctx, getHeaderDisplayNames, toolsetID)
	var header_display_names []byte
	err := row.Scan(&header_display_names)
	return header_display_names, err
}

const getMetadataForToolset = `-- name: GetMetadataForToolset :one
SELECT id,
       toolset_id,
       project_id,
       external_documentation_url,
       logo_id,
       instructions,
       header_display_names,
       default_environment_id,
       installation_override_url,
       created_at,
       updated_at
FROM mcp_metadata
WHERE toolset_id = $1
ORDER BY updated_at DESC
LIMIT 1
`

func (q *Queries) GetMetadataForToolset(ctx context.Context, toolsetID uuid.UUID) (McpMetadatum, error) {
	row := q.db.QueryRow(ctx, getMetadataForToolset, toolsetID)
	var i McpMetadatum
	err := row.Scan(
		&i.ID,
		&i.ToolsetID,
		&i.ProjectID,
		&i.ExternalDocumentationUrl,
		&i.LogoID,
		&i.Instructions,
		&i.HeaderDisplayNames,
		&i.DefaultEnvironmentID,
		&i.InstallationOverrideUrl,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const listEnvironmentConfigs = `-- name: ListEnvironmentConfigs :many
SELECT id,
       project_id,
       mcp_metadata_id,
       variable_name,
       header_display_name,
       provided_by,
       created_at,
       updated_at
FROM mcp_environment_configs
WHERE mcp_metadata_id = $1
ORDER BY variable_name ASC
`

func (q *Queries) ListEnvironmentConfigs(ctx context.Context, mcpMetadataID uuid.UUID) ([]McpEnvironmentConfig, error) {
	rows, err := q.db.Query(ctx, listEnvironmentConfigs, mcpMetadataID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []McpEnvironmentConfig
	for rows.Next() {
		var i McpEnvironmentConfig
		if err := rows.Scan(
			&i.ID,
			&i.ProjectID,
			&i.McpMetadataID,
			&i.VariableName,
			&i.HeaderDisplayName,
			&i.ProvidedBy,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const upsertEnvironmentConfig = `-- name: UpsertEnvironmentConfig :one
INSERT INTO mcp_environment_configs (
    project_id,
    mcp_metadata_id,
    variable_name,
    header_display_name,
    provided_by
) VALUES ($1, $2, $3, $4, $5)
ON CONFLICT (mcp_metadata_id, variable_name)
DO UPDATE SET header_display_name = EXCLUDED.header_display_name,
              provided_by = EXCLUDED.provided_by,
              updated_at = clock_timestamp()
RETURNING id,
          project_id,
          mcp_metadata_id,
          variable_name,
          header_display_name,
          provided_by,
          created_at,
          updated_at
`

type UpsertEnvironmentConfigParams struct {
	ProjectID         uuid.UUID
	McpMetadataID     uuid.UUID
	VariableName      string
	HeaderDisplayName pgtype.Text
	ProvidedBy        string
}

func (q *Queries) UpsertEnvironmentConfig(ctx context.Context, arg UpsertEnvironmentConfigParams) (McpEnvironmentConfig, error) {
	row := q.db.QueryRow(ctx, upsertEnvironmentConfig,
		arg.ProjectID,
		arg.McpMetadataID,
		arg.VariableName,
		arg.HeaderDisplayName,
		arg.ProvidedBy,
	)
	var i McpEnvironmentConfig
	err := row.Scan(
		&i.ID,
		&i.ProjectID,
		&i.McpMetadataID,
		&i.VariableName,
		&i.HeaderDisplayName,
		&i.ProvidedBy,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const upsertMetadata = `-- name: UpsertMetadata :one
INSERT INTO mcp_metadata (
    toolset_id,
    project_id,
    external_documentation_url,
    logo_id,
    instructions,
    default_environment_id,
    installation_override_url
) VALUES ($1, $2, $3, $4, $5, $6, $7)
ON CONFLICT (toolset_id)
DO UPDATE SET project_id = EXCLUDED.project_id,
              external_documentation_url = EXCLUDED.external_documentation_url,
              logo_id = EXCLUDED.logo_id,
              instructions = EXCLUDED.instructions,
              default_environment_id = EXCLUDED.default_environment_id,
              installation_override_url = EXCLUDED.installation_override_url,
              updated_at = clock_timestamp()
RETURNING id,
          toolset_id,
          project_id,
          external_documentation_url,
          logo_id,
          instructions,
          header_display_names,
          default_environment_id,
          installation_override_url,
          created_at,
          updated_at
`

type UpsertMetadataParams struct {
	ToolsetID                uuid.UUID
	ProjectID                uuid.UUID
	ExternalDocumentationUrl pgtype.Text
	LogoID                   uuid.NullUUID
	Instructions             pgtype.Text
	DefaultEnvironmentID     uuid.NullUUID
	InstallationOverrideUrl  pgtype.Text
}

func (q *Queries) UpsertMetadata(ctx context.Context, arg UpsertMetadataParams) (McpMetadatum, error) {
	row := q.db.QueryRow(ctx, upsertMetadata,
		arg.ToolsetID,
		arg.ProjectID,
		arg.ExternalDocumentationUrl,
		arg.LogoID,
		arg.Instructions,
		arg.DefaultEnvironmentID,
		arg.InstallationOverrideUrl,
	)
	var i McpMetadatum
	err := row.Scan(
		&i.ID,
		&i.ToolsetID,
		&i.ProjectID,
		&i.ExternalDocumentationUrl,
		&i.LogoID,
		&i.Instructions,
		&i.HeaderDisplayNames,
		&i.DefaultEnvironmentID,
		&i.InstallationOverrideUrl,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}
